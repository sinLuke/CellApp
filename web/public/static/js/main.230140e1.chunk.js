(window["webpackJsonpcell-app-react"]=window["webpackJsonpcell-app-react"]||[]).push([[0],{226:function(e,t,a){e.exports=a(406)},231:function(e,t,a){},383:function(e,t){},385:function(e,t){},406:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),n=a(49),o=a.n(n);a(231),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(232);var l=a(216),r=a(21),p=a(22),c=a(25),d=a(23),u=a(19),h=a(24),m=a(20),E=a.n(m),g=E.a.initializeApp({apiKey:"AIzaSyBM-C_d1o-gVCFRQykdbBI4svOSed8JbDY",authDomain:"cell-app.firebaseapp.com",databaseURL:"https://cell-app.firebaseio.com",projectId:"cell-app",storageBucket:"cell-app.appspot.com",messagingSenderId:"854633007097",appId:"1:854633007097:web:0f1cadc2d35c247e2fdf28",measurementId:"G-3ZZ2QEG61Z"}),b=a(59),f=a(52),I=a(422),S=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(I.a,{inverted:this.props.editAnimation,fixed:"top"},s.a.createElement(I.a.Item,null,s.a.createElement(b.b,{to:"/",onClick:function(){E.a.auth().signOut()}},"Sign Out")),s.a.createElement(I.a.Item,{to:"/home"},s.a.createElement(b.b,null,"Home")))}}]),t}(s.a.Component),v=a(199),O=a.n(v),L=a(423),U=a(424),A=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={user:E.a.auth().currentUser},E.a.auth().onAuthStateChanged(function(e){e?(console.log("set user",e),this.setState({user:e})):(console.log("set user",null),this.setState({user:null}))}.bind(Object(u.a)(a))),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){if(this.state.user)return s.a.createElement(f.a,{to:"/home"});var e={signInFlow:"popup",callbacks:{signInSuccessWithAuthResult:function(e,t){return!1}},signInOptions:[E.a.auth.GoogleAuthProvider.PROVIDER_ID,E.a.auth.EmailAuthProvider.PROVIDER_ID]};return s.a.createElement("div",null,s.a.createElement(L.a,{container:!0,stackable:!0,verticalAlign:"top"},s.a.createElement(L.a.Row,null,s.a.createElement(L.a.Column,{width:4}),s.a.createElement(L.a.Column,{width:8},s.a.createElement(U.a,{size:"huge",style:{fontWeight:"normal",marginTop:"2em",marginLeft:"2em",marginBottom:"2em"}},"Login"),s.a.createElement(O.a,{uiConfig:e,firebaseAuth:E.a.auth()})),s.a.createElement(L.a.Column,{width:4}))))}}]),t}(s.a.Component),C=a(421),y=a(62),T=a(407),N=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={loading:e.loading,type:e.type},a.getCellContent=a.getCellContent.bind(Object(u.a)(a)),a.getAddButtonLabel=a.getAddButtonLabel.bind(Object(u.a)(a)),a.cellClicked=a.cellClicked.bind(Object(u.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"getCellContent",value:function(e){switch(this.state.type){case 0:return e.TOPIC_NAME;case 1:return e.DOCUMENT_NAME;case 2:return"Step ".concat(e.PAGE_NUMBER+1);default:return e.DESCRIPTION}}},{key:"getAddButtonLabel",value:function(){switch(this.state.type){case 0:return"Add Topic";case 1:return"Add Document";case 2:return"Add Step";default:return"Add Animation Item"}}},{key:"cellClicked",value:function(e){this.props.setSelected(e)}},{key:"componentWillReceiveProps",value:function(){this.state.loading&&this.setState({loading:!1})}},{key:"render",value:function(){var e=this;return console.log("itemList item prop",this.props.items),s.a.createElement(C.a,{celled:!0,disabled:this.props.isUploading,inverted:this.props.editAnimation},s.a.createElement(C.a.Header,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,{singleLine:!0},this.props.title),3===this.props.type?s.a.createElement(C.a.HeaderCell,null,"Edit"):" ")),s.a.createElement(C.a.Body,{padded:!0},this.props.items.map((function(t){return s.a.createElement(C.a.Row,{style:{cursor:"pointer"},key:t.id,onClick:function(){this.props.isUploading||this.cellClicked(t.id)}.bind(e)},s.a.createElement(C.a.Cell,{warning:e.props.selected!==t.id&&e.props.changed.has(t.id)&&!e.props.editAnimation,style:{backgroundColor:e.props.editAnimation?e.props.selected===t.id?"#0a84ffff":"#333333ff":e.props.selected===t.id?"#007affff":"white",color:e.props.editAnimation?e.props.selected===t.id?"#black":"white":e.props.selected===t.id?"white":"black"}},e.props.changed.has(t.id)?s.a.createElement(y.a,{name:"dot circle outline"}):" ",e.getCellContent(t)),3===e.props.type?s.a.createElement(C.a.Cell,{warning:e.props.selected!==t.id&&e.props.changed.has(t.id)&&!e.props.editAnimation,style:{backgroundColor:e.props.editAnimation?e.props.selected===t.id?"#0a84ffff":"#333333ff":e.props.selected===t.id?"#007affff":"white",color:e.props.editAnimation?e.props.selected===t.id?"#black":"white":e.props.selected===t.id?"white":"black"}},t.IMAGE_URL?s.a.createElement(T.a,{color:"red",disabled:!t.IMAGE_URL||e.props.isUploading,onClick:function(){this.props.setKeyValue(3,t.id,null,"IMAGE_URL",null)}.bind(e)},"Delete Image"):"No Image Uploaded"):" ")}))),s.a.createElement(C.a.Footer,{fullWidth:!0},s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,{colSpan:"4"},s.a.createElement(T.a,{floated:"left",icon:!0,labelPosition:"right",size:"small",primary:!0,loading:this.state.loading,disabled:this.state.loading,onClick:function(){this.state.loading||(this.setState({loading:!0}),this.props.add())}.bind(this)},s.a.createElement(y.a,{name:"add"})," ",this.getAddButtonLabel())))))}}]),t}(s.a.Component),_=a(425),k=a(420),P=a(416),R=a(417),w=a(418),M=a(81),j=a(215),D=a(419),G=a(50),V=a.n(G),H=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;console.log("topicList",this.props);var t=Object.values(this.props.documentList).map(function(e){return this.props.topicList[e.TOPIC_ID]?{key:e.id,text:"".concat(this.props.topicList[e.TOPIC_ID].TOPIC_NAME," - ").concat(e.DOCUMENT_NAME),value:e.id}:{key:e.id,text:"".concat(e.DOCUMENT_NAME),value:e.id}}.bind(this)).sort((function(e,t){return e.text>t.text?-1:e.text<t.text?1:0}));return s.a.createElement(C.a,{celled:!0},s.a.createElement(C.a.Header,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,null,this.props.title))),s.a.createElement(C.a.Body,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.Cell,null,s.a.createElement(k.a,null,s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"step-detail-id-field",control:P.a,label:"Step ID",value:this.props.step.id,disabled:!0})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{options:t,control:R.a,label:{children:"In Document",htmlFor:"step-detail-document-id"},value:this.props.step.DOCUMENT_ID,onChange:function(e,t){var a=t.value;this.props.setKeyValue("DOCUMENT_ID",a)}.bind(this),disabled:!0})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{control:P.a,label:{children:"Page Number",htmlFor:"step-detail-page-number-field"},value:function(){return isNaN(this.props.step.PAGE_NUMBER)?0:this.props.step.PAGE_NUMBER+1}.bind(this)(),onChange:function(e,t){var a=t.value,i=parseInt(a);isNaN(i)&&(i=1),this.props.setKeyValue("PAGE_NUMBER",i-1)}.bind(this)}),s.a.createElement(k.a.Field,{options:[{key:"interactive",text:"Interactive Animation",value:0},{key:"auto",text:"Auto Animation",value:1},{key:"choice_quiz",text:"Multiple Choice",value:10},{key:"fill_quiz",text:"Fill Blanks",value:11}],control:R.a,label:{children:"Type",htmlFor:"step-detail-animation-field"},value:this.props.step.TYPE,onChange:function(e,t){var a=t.value;this.props.setKeyValue("TYPE",a)}.bind(this)})),s.a.createElement(k.a.Field,{id:"step-detail-text-area",control:w.a,label:"Text",value:this.props.step.TEXT,onChange:function(e,t){var a=t.value;this.props.setKeyValue("TEXT",a)}.bind(this)}),10==this.props.step.TYPE?s.a.createElement(k.a.Field,{id:"step-detail-choices-area",control:w.a,label:'Choices (seperate by ",")',value:this.props.step.CHOICES,onChange:function(e,t){var a=t.value;this.props.setKeyValue("CHOICES",a)}.bind(this)}):" ",10==this.props.step.TYPE||11==this.props.step.TYPE?s.a.createElement(k.a.Field,{id:"step-detail-answer-area",control:w.a,label:"Answer",disabled:10==this.props.step.TYPE,value:this.props.step.ANSWER,onChange:function(e,t){var a=t.value;this.props.setKeyValue("ANSWER",a)}.bind(this)}):" ",10==this.props.step.TYPE||11==this.props.step.TYPE?s.a.createElement(k.a.Field,{id:"step-detail-answer-explanation-area",control:w.a,label:"Answer Explanation",value:this.props.step.ANSWER_EXPLANATION,onChange:function(e,t){var a=t.value;this.props.setKeyValue("ANSWER_EXPLANATION",a)}.bind(this)}):" ",10==this.props.step.TYPE&&this.props.step.CHOICES?s.a.createElement("div",{style:{paddingBottom:"0.5em"}},s.a.createElement(k.a.Field,{id:"step-detail-choice-field",label:"Select the correct answer"}),this.props.step.CHOICES.trim().split(",").filter((function(e){return""!==e.trim().toLowerCase()})).map((function(t){return s.a.createElement("div",null,e.props.step.ANSWER.trim().toLowerCase()===t.trim().toLowerCase()&&""!==t.trim().toLowerCase()?s.a.createElement(M.a,{color:"red",style:{margin:"0.2em"}},s.a.createElement(y.a,{name:"check"}),t):s.a.createElement(M.a,{as:"a",onClick:function(){return e.props.setKeyValue("ANSWER",t.trim())},style:{margin:"0.2em"}},t),s.a.createElement("br",null))}))):" ",s.a.createElement(k.a.Field,{label:"Step Image"}),this.props.step.IMAGE_URL?s.a.createElement(_.a,null,s.a.createElement(j.a,{fluid:!0,draggable:"false",src:this.props.step.IMAGE_URL})):" ",this.props.isUploading?s.a.createElement(D.a,{color:"grey",percent:this.props.progress,indicating:!0}):s.a.createElement(k.a.Group,null,s.a.createElement("label",{style:{backgroundColor:"lightGrey",color:"black",marginLeft:8,padding:8,paddingLeft:16,paddingRight:16,borderRadius:4,cursor:"pointer"}},s.a.createElement("b",null,"Upload an Image"),s.a.createElement(V.a,{accept:"image/*",name:"step_image",randomizeFilename:!0,hidden:!0,storageRef:E.a.storage().ref("images"),onUploadStart:function(){this.props.uploadHelpers.handleUploadStart(this.props.step.id)}.bind(this),onUploadError:this.props.uploadHelpers.handleUploadError,onUploadSuccess:function(e){this.props.uploadHelpers.handleUploadSuccess(2,this.props.step.id,e)}.bind(this),onProgress:this.props.uploadHelpers.handleProgress,disabled:this.props.isUploading})),s.a.createElement(k.a.Field,{id:"step-detail-remove-image",control:T.a,content:"Remove Image",color:"red",disabled:!this.props.step.IMAGE_URL||this.props.isUploading,onClick:function(){this.props.setKeyValue("IMAGE_URL",null)}.bind(this)})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"step-detail-image-subtitle-field",control:P.a,label:"Image Subtitle",value:this.props.step.IMAGE_SUBTITLE,onChange:function(e,t){var a=t.value;this.props.setKeyValue("IMAGE_SUBTITLE",a)}.bind(this)})),s.a.createElement(k.a.Field,{id:"step-detail-comform",control:T.a,content:"Save",primary:!0,disabled:!this.props.changed.has(this.props.step.id)||this.props.isUploading,onClick:function(){this.props.uploadHelpers.update(2,this.props.step.id)}.bind(this)}))))))}}]),t}(s.a.Component),K=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=Object.values(this.props.topicList).map((function(e){return{key:e.id,text:e.TOPIC_NAME,value:e.id}}));return s.a.createElement(C.a,{celled:!0},s.a.createElement(C.a.Header,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,null,this.props.title))),s.a.createElement(C.a.Body,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.Cell,null,s.a.createElement(k.a,null,s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"document-detail-id-field",control:P.a,label:"Document ID",value:this.props.document.id,disabled:!0})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"document-detail-name-field",control:P.a,label:"Document Name",value:this.props.document.DOCUMENT_NAME,onChange:function(e,t){var a=t.value;this.props.setKeyValue("DOCUMENT_NAME",a)}.bind(this)})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{options:e,control:R.a,label:{children:"In Topic",htmlFor:"document-detail-topic-id"},value:this.props.document.TOPIC_ID,onChange:function(e,t){var a=t.value;this.props.setKeyValue("TOPIC_ID",a)}.bind(this)})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"document-detail-difficulty-field",control:P.a,label:"Difficulty",value:function(){return isNaN(this.props.document.DIFFICULTY)?0:this.props.document.DIFFICULTY}.bind(this)(),onChange:function(e,t){var a=t.value,i=parseInt(a);(isNaN(i)||i<1)&&(i=0),this.props.setKeyValue("DIFFICULTY",i)}.bind(this)}),s.a.createElement(k.a.Field,{id:"document-detail-pagenumber-field",control:P.a,label:"Page Number",value:function(){return isNaN(this.props.document.PAGE_NUMBER)?0:this.props.document.PAGE_NUMBER+1}.bind(this)(),onChange:function(e,t){var a=t.value,i=parseInt(a);(isNaN(i)||i<0)&&(i=1),this.props.setKeyValue("PAGE_NUMBER",i-1)}.bind(this)})),s.a.createElement(k.a.Field,{id:"document-detail-text-area",control:w.a,label:"Introduction",value:this.props.document.INTRODUCTION,onChange:function(e,t){var a=t.value;this.props.setKeyValue("INTRODUCTION",a)}.bind(this)}),s.a.createElement(k.a.Field,{label:"Document Image"}),this.props.document.IMAGE_URL?s.a.createElement(_.a,null,s.a.createElement(j.a,{draggable:"false",fluid:!0,src:this.props.document.IMAGE_URL})):" ",this.props.isUploading?s.a.createElement(D.a,{color:"grey",percent:this.props.progress,indicating:!0}):s.a.createElement(k.a.Group,null,s.a.createElement("label",{style:{backgroundColor:"lightGrey",color:"black",marginLeft:8,padding:8,paddingLeft:16,paddingRight:16,borderRadius:4,cursor:"pointer"}},s.a.createElement("b",null,"Upload an Image"),s.a.createElement(V.a,{accept:"image/*",name:"document_image",randomizeFilename:!0,hidden:!0,storageRef:E.a.storage().ref("images"),onUploadStart:function(){this.props.uploadHelpers.handleUploadStart(this.props.document.id)}.bind(this),onUploadError:this.props.uploadHelpers.handleUploadError,onUploadSuccess:function(e){this.props.uploadHelpers.handleUploadSuccess(1,this.props.document.id,e)}.bind(this),onProgress:this.props.uploadHelpers.handleProgress,disabled:this.props.isUploading})),s.a.createElement(k.a.Field,{id:"document-detail-remove-image",control:T.a,content:"Remove Image",color:"red",disabled:!this.props.document.IMAGE_URL||this.props.isUploading,onClick:function(){this.props.setKeyValue("IMAGE_URL",null)}.bind(this)})),s.a.createElement(k.a.Field,{id:"step-detail-comform",control:T.a,content:"Save",primary:!0,disabled:!this.props.changed.has(this.props.document.id)||this.props.isUploading,onClick:function(){this.props.uploadHelpers.update(1,this.props.document.id)}.bind(this)}))))))}}]),t}(s.a.Component),F=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(C.a,{celled:!0},s.a.createElement(C.a.Header,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,null,this.props.title))),s.a.createElement(C.a.Body,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.Cell,null,s.a.createElement(k.a,null,s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"topic-detail-id-field",control:P.a,label:"Topic ID",value:this.props.topic.id,disabled:!0})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"step-detail-image-subtitle-field",control:P.a,label:"Topic Name",value:this.props.topic.TOPIC_NAME,onChange:function(e,t){var a=t.value;this.props.setKeyValue("TOPIC_NAME",a)}.bind(this)})),s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"step-detail-page-number-field",control:P.a,label:"Page Number",value:function(){return isNaN(this.props.topic.PAGE_NUMBER)?0:this.props.topic.PAGE_NUMBER+1}.bind(this)(),onChange:function(e,t){var a=t.value,i=parseInt(a);(isNaN(i)||i<0)&&(i=1),this.props.setKeyValue("PAGE_NUMBER",i-1)}.bind(this)})),s.a.createElement(k.a.Field,{label:"Topic Image"}),this.props.topic.IMAGE_URL?s.a.createElement(_.a,null,s.a.createElement(j.a,{draggable:"false",fluid:!0,src:this.props.topic.IMAGE_URL})):" ",this.props.isUploading?s.a.createElement(D.a,{color:"grey",percent:this.props.progress,indicating:!0}):s.a.createElement(k.a.Group,null,s.a.createElement("label",{style:{backgroundColor:"lightGrey",color:"black",marginLeft:8,padding:8,paddingLeft:16,paddingRight:16,borderRadius:4,cursor:"pointer"}},s.a.createElement("b",null,"Upload an Image"),s.a.createElement(V.a,{accept:"image/*",name:"topic_image",randomizeFilename:!0,hidden:!0,storageRef:E.a.storage().ref("images"),onUploadStart:function(){this.props.uploadHelpers.handleUploadStart(this.props.topic.id)}.bind(this),onUploadError:this.props.uploadHelpers.handleUploadError,onUploadSuccess:function(e){this.props.uploadHelpers.handleUploadSuccess(0,this.props.topic.id,e)}.bind(this),onProgress:this.props.uploadHelpers.handleProgress,disabled:this.props.isUploading})),s.a.createElement(k.a.Field,{id:"step-detail-remove-image",control:T.a,content:"Remove Image",color:"red",disabled:!this.props.topic.IMAGE_URL||this.props.isUploading,onClick:function(){this.props.setKeyValue("IMAGE_URL",null)}.bind(this)})),s.a.createElement(k.a.Field,{id:"step-detail-comform",control:T.a,content:"Save",primary:!0,disabled:!this.props.changed.has(this.props.topic.id)||this.props.isUploading,onClick:function(){this.props.uploadHelpers.update(0,this.props.topic.id)}.bind(this)}))))))}}]),t}(s.a.Component),B=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.topicSelected?this.props.documentSelected?this.props.stepSelected?s.a.createElement(H,{step:this.props.lists.stepList[this.props.stepSelected],stepCount:this.props.filterStepList(this.props.documentSelected).length,title:"".concat(this.props.lists.documentList[this.props.documentSelected].DOCUMENT_NAME," - Step ").concat(this.props.lists.stepList[this.props.stepSelected].PAGE_NUMBER+1),changed:this.props.changed,uploadHelpers:this.props.uploadHelpers,setKeyValue:function(e,t){this.props.setKeyValue(2,this.props.stepSelected,this.props.documentSelected,e,t)}.bind(this),isUploading:this.props.isUploading,progress:this.props.progress,documentList:this.props.lists.documentList,topicList:this.props.lists.topicList}):s.a.createElement(K,{document:this.props.lists.documentList[this.props.documentSelected],changed:this.props.changed,title:"".concat(this.props.lists.documentList[this.props.documentSelected].DOCUMENT_NAME),uploadHelpers:this.props.uploadHelpers,setKeyValue:function(e,t){this.props.setKeyValue(1,this.props.documentSelected,this.props.topicSelected,e,t)}.bind(this),isUploading:this.props.isUploading,progress:this.props.progress,topicList:this.props.lists.topicList}):s.a.createElement(F,{topic:this.props.lists.topicList[this.props.topicSelected],changed:this.props.changed,uploadHelpers:this.props.uploadHelpers,title:"".concat(this.props.lists.topicList[this.props.topicSelected].TOPIC_NAME),setKeyValue:function(e,t){this.props.setKeyValue(0,this.props.topicSelected,null,e,t)}.bind(this),isUploading:this.props.isUploading,progress:this.props.progress}):s.a.createElement(_.a,{disabled:!0,textAlign:"center"},"Select anything on the left")}}]),t}(s.a.Component),x=a(415),Y=a(214),z=a.n(Y),q=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={width:100,height:100},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.setState({width:this.container.offsetWidth,height:this.container.offsetHeight})}},{key:"render",value:function(){var e=this;return console.log(this.props.items),s.a.createElement("div",{ref:function(t){return e.container=t},style:{width:"100%",height:"100%"}},this.props.items.map((function(t){return s.a.createElement(z.a,{style:{zIndex:t.id===e.props.item.id?"100":"1",position:"absolute"},onStart:function(){return t.id===e.props.item.id},bounds:"parent",onStop:function(t,a){var i=a.x,s=a.y;e.props.onControlledDragStop(t,i/.01/e.state.width,s/.01/e.state.height)},position:{x:.01*(e.props.start?t.START_POSITION_X:t.END_POSITION_X)*e.state.width,y:.01*(e.props.start?t.START_POSITION_Y:t.END_POSITION_Y)*e.state.height}},s.a.createElement(j.a,{style:{position:"absolute",height:"".concat(t.SIZE,"%"),outline:t.id===e.props.item.id?"2px dotted #000000":"",backgroundColor:t.id===e.props.item.id?"rgba(255, 255, 0, 0.3)":""},src:t.IMAGE_URL,draggable:"false"}))})))}}]),t}(s.a.Component),W=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={start:!0},a.changeStartEnd=a.changeStartEnd.bind(Object(u.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"changeStartEnd",value:function(e,t){this.setState({start:!t.checked})}},{key:"render",value:function(){var e=this;console.log("topicList",this.props);Object.values(this.props.documentList).map(function(e){return this.props.topicList[e.TOPIC_ID]?{key:e.id,text:"".concat(this.props.topicList[e.TOPIC_ID].TOPIC_NAME," - ").concat(e.DOCUMENT_NAME),value:e.id}:{key:e.id,text:"".concat(e.DOCUMENT_NAME),value:e.id}}.bind(this)).sort((function(e,t){return e.text>t.text?-1:e.text<t.text?1:0}));return s.a.createElement(C.a,{compact:!0,celled:!0,color:"black",inverted:!0},s.a.createElement(C.a.Header,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.HeaderCell,null,"Animations - ",this.props.title),s.a.createElement(C.a.HeaderCell,{verticalAlign:"middle"},"Start"," ",s.a.createElement(x.a,{style:{paddingTop:"4px",marginLeft:"16px",marginRight:"16px"},slider:!0,value:this.state.start,onChange:this.changeStartEnd})," ","End"))),s.a.createElement(C.a.Body,null,s.a.createElement(C.a.Row,null,s.a.createElement(C.a.Cell,{style:{padding:"16px"}},s.a.createElement("div",{className:"animation_image_canvas",style:{position:"relative"}},s.a.createElement(j.a,{src:this.props.step.IMAGE_URL,fluid:!0}),s.a.createElement("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},s.a.createElement(q,{start:this.state.start,item:this.props.item,items:Object.values(this.props.lists).filter((function(t){return t.STEP_ID===e.props.item.STEP_ID})),onControlledDragStop:function(t,a,i){e.state.start?(e.props.setKeyValue("START_POSITION_X",a),e.props.setKeyValue("START_POSITION_Y",i)):(e.props.setKeyValue("END_POSITION_X",a),e.props.setKeyValue("END_POSITION_Y",i))}})))))),s.a.createElement(C.a.Footer,{fullWidth:!0},s.a.createElement(C.a.Row,null,s.a.createElement(C.a.Cell,null,s.a.createElement(k.a,{inverted:!0},s.a.createElement(k.a.Group,{widths:"equal"},s.a.createElement(k.a.Field,{id:"animation-item-detail-size-field",control:P.a,label:"Description",value:this.props.item.DESCRIPTION,onChange:function(e,t){var a=t.value;this.props.setKeyValue("DESCRIPTION",a)}.bind(this)}),s.a.createElement(k.a.Field,{id:"animation-item-detail-size-field",control:P.a,label:"Size",value:function(){return isNaN(this.props.item.SIZE)?"10":this.props.item.SIZE}.bind(this)(),onChange:function(e,t){var a=t.value;this.props.setKeyValue("SIZE",a)}.bind(this)})))))))}}]),t}(s.a.Component),X=function(e){function t(e){return Object(r.a)(this,t),Object(c.a)(this,Object(d.a)(t).call(this,e))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.lists.stepList[this.props.stepSelected];return this.props.topicSelected&&this.props.documentSelected&&this.props.stepSelected?e&&e.IMAGE_URL?this.props.item?this.props.item.IMAGE_URL?(console.log(this.props.lists.animationItemList),console.log(this.props.item),s.a.createElement(W,{step:this.props.lists.stepList[this.props.stepSelected],item:this.props.item,stepCount:this.props.filterAnimationList(this.props.stepSelected).length,title:"".concat(this.props.lists.documentList[this.props.documentSelected].DOCUMENT_NAME," - Step ").concat(this.props.lists.stepList[this.props.stepSelected].PAGE_NUMBER),changed:this.props.changed,uploadHelpers:this.props.uploadHelpers,setKeyValue:function(e,t){this.props.setKeyValue(3,this.props.item.id,this.props.stepSelected,e,t)}.bind(this),lists:this.props.lists.animationItemList,isUploading:this.props.isUploading,progress:this.props.progress,documentList:this.props.lists.documentList,topicList:this.props.lists.topicList})):(console.log(this.props.item),s.a.createElement("div",null,s.a.createElement(_.a,{warning:!0,disabled:!0,inverted:!0,textAlign:"center"},"Upload an image to create animationItem."),this.props.isUploading?s.a.createElement(D.a,{color:"grey",percent:this.props.progress,indicating:!0}):s.a.createElement(k.a,null,s.a.createElement(k.a.Group,null,s.a.createElement("label",{style:{backgroundColor:"lightGrey",color:"black",marginLeft:8,padding:8,paddingLeft:16,paddingRight:16,borderRadius:4,cursor:"pointer"}},s.a.createElement("b",null,"Upload an Image"),s.a.createElement(V.a,{accept:"image/*",name:"step_image",randomizeFilename:!0,hidden:!0,storageRef:E.a.storage().ref("images"),onUploadStart:function(){this.props.uploadHelpers.handleUploadStart(this.props.item.id)}.bind(this),onUploadError:this.props.uploadHelpers.handleUploadError,onUploadSuccess:function(e){this.props.uploadHelpers.handleUploadSuccess(3,this.props.item.id,e)}.bind(this),onProgress:this.props.uploadHelpers.handleProgress,disabled:this.props.isUploading})))))):s.a.createElement(_.a,{warning:!0,disabled:!0,inverted:!0,textAlign:"center"},"Please add an animation item to add animation to this step."):s.a.createElement(_.a,{warning:!0,disabled:!0,inverted:!0,textAlign:"center"},"Please upload an image to add animations on this step."):s.a.createElement(_.a,{warning:!0,disabled:!0,textAlign:"center"},"Please select a step to edit the animation.")}}]),t}(s.a.Component),Z=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={user:E.a.auth().currentUser,admin:!1,topic:null,document:null,step:null,edit:!1},E.a.auth().onAuthStateChanged(function(e){e?(this.setState({user:e}),e.email&&this.setState({admin:"yinluke@gmail.com"===E.a.auth().currentUser.email||"patelks2394@gmail.com"===E.a.auth().currentUser.email||"yinaiguo@gmail.com"===E.a.auth().currentUser.email})):this.setState({user:null})}.bind(Object(u.a)(a))),a.filterDocumentList=a.filterDocumentList.bind(Object(u.a)(a)),a.filterStepList=a.filterStepList.bind(Object(u.a)(a)),a.filterAnimationList=a.filterAnimationList.bind(Object(u.a)(a)),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"filterDocumentList",value:function(e){return Object.values(this.props.lists.documentList).filter((function(t){return t.TOPIC_ID===e}))}},{key:"filterStepList",value:function(e){return Object.values(this.props.lists.stepList).filter((function(t){return t.DOCUMENT_ID===e}))}},{key:"filterAnimationList",value:function(e){return Object.values(this.props.lists.animationItemList).filter((function(t){return t.STEP_ID===e}))}},{key:"render",value:function(){var e=this;return this.state.user?this.state.admin?s.a.createElement("div",null,s.a.createElement(L.a,{columns:"equal",verticalAlign:"top",style:{padding:"16px"}},s.a.createElement(L.a.Row,{stretched:!0},this.props.editAnimation?" ":s.a.createElement(L.a.Column,{width:3},s.a.createElement(N,{selected:this.props.topicSelected,setSelected:function(t){return e.props.setSelected(0,t)},items:Object.values(this.props.lists.topicList).sort((function(e,t){return e.PAGE_NUMBER<t.PAGE_NUMBER?-1:e.PAGE_NUMBER>t.PAGE_NUMBER?1:e.created<t.created?-1:e.created>t.created?1:0})),title:"Topics",add:function(){return e.props.add(0,null)},loading:!1,type:0,setKeyValue:this.props.setKeyValue,changed:this.props.changed,isUploading:this.props.isUploading,progress:this.props.progress,editAnimation:this.props.editAnimation})),this.props.topicSelected&&!this.props.editAnimation?s.a.createElement(L.a.Column,{width:3},s.a.createElement(N,{selected:this.props.documentSelected,setSelected:function(t){return e.props.setSelected(1,t)},items:this.filterDocumentList(this.props.topicSelected).sort((function(e,t){return e.PAGE_NUMBER<t.PAGE_NUMBER?-1:e.PAGE_NUMBER>t.PAGE_NUMBER?1:e.created<t.created?-1:e.created>t.created?1:0})),title:this.props.lists.topicList[this.props.topicSelected]?this.props.lists.topicList[this.props.topicSelected].TOPIC_NAME:"Docuemnt",add:function(t){return e.props.add(1,e.props.topicSelected)},loading:!1,type:1,setKeyValue:this.props.setKeyValue,changed:this.props.changed,isUploading:this.props.isUploading,progress:this.props.progress,editAnimation:this.props.editAnimation})):" ",this.props.documentSelected?s.a.createElement(L.a.Column,{width:2},s.a.createElement(N,{selected:this.props.stepSelected,setSelected:function(t){return e.props.setSelected(2,t)},items:this.filterStepList(this.props.documentSelected).sort((function(e,t){return e.PAGE_NUMBER<t.PAGE_NUMBER?-1:e.PAGE_NUMBER>t.PAGE_NUMBER?1:0})),title:this.props.lists.documentList[this.props.documentSelected].DOCUMENT_NAME,add:function(t){return e.props.add(2,e.props.documentSelected)},loading:!1,type:2,setKeyValue:this.props.setKeyValue,changed:this.props.changed,isUploading:this.props.isUploading,progress:this.props.progress,editAnimation:this.props.editAnimation})):" ",this.props.editAnimation?s.a.createElement(L.a.Column,{width:6},s.a.createElement(N,{selected:this.props.animationItemSelected,setSelected:function(t){return e.props.setSelected(3,t)},items:this.filterAnimationList(this.props.stepSelected),title:"".concat(this.props.lists.documentList[this.props.documentSelected].DOCUMENT_NAME," - Step ").concat(this.props.lists.stepList[this.props.stepSelected].PAGE_NUMBER+1),add:function(t){return e.props.add(3,e.props.stepSelected)},loading:!1,type:3,setKeyValue:this.props.setKeyValue,changed:this.props.changed,isUploading:this.props.isUploading,progress:this.props.progress,editAnimation:this.props.editAnimation})):" ",this.props.editAnimation&&this.props.stepSelected?s.a.createElement(L.a.Column,null,s.a.createElement(X,{topicSelected:this.props.topicSelected,documentSelected:this.props.documentSelected,stepSelected:this.props.stepSelected,item:this.props.lists.animationItemList[this.props.animationItemSelected],lists:this.props.lists,add:this.props.add,filterAnimationList:this.filterAnimationList,changed:this.props.changed,setKeyValue:this.props.setKeyValue,uploadHelpers:this.props.uploadHelpers,isUploading:this.props.isUploading,progress:this.props.progress})):s.a.createElement(L.a.Column,null,s.a.createElement(B,{topicSelected:this.props.topicSelected,documentSelected:this.props.documentSelected,stepSelected:this.props.stepSelected,lists:this.props.lists,add:this.props.add,filterStepList:this.filterStepList,changed:this.props.changed,setKeyValue:this.props.setKeyValue,uploadHelpers:this.props.uploadHelpers,isUploading:this.props.isUploading,progress:this.props.progress}))))):s.a.createElement("div",{style:{margin:"4em"}},s.a.createElement(_.a,null,this.state.user.displayName," is not an administrator")):s.a.createElement(f.a,{to:"/"})}}]),t}(s.a.Component),J=(a(379),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={topic:null,document:null,step:null,animationItem:null,topicList:{},stepList:{},documentList:{},animationItemList:{},currentVersion:null,changed:new Set,isUploading:null,progress:0,editAnimation:!1},a.setSelected=a.setSelected.bind(Object(u.a)(a)),a.load=a.load.bind(Object(u.a)(a)),a.add=a.add.bind(Object(u.a)(a)),a.update=a.update.bind(Object(u.a)(a)),a.updateAll=a.updateAll.bind(Object(u.a)(a)),a.setKeyValue=a.setKeyValue.bind(Object(u.a)(a)),a.uploadHelpers={handleUploadStart:a.handleUploadStart.bind(Object(u.a)(a)),handleProgress:a.handleProgress.bind(Object(u.a)(a)),handleUploadError:a.handleUploadError.bind(Object(u.a)(a)),handleUploadSuccess:a.handleUploadSuccess.bind(Object(u.a)(a)),update:a.update.bind(Object(u.a)(a))},a.db=g.firestore(),a.load(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"handleUploadStart",value:function(e){console.log("handleUploadStart",e),this.setState({isUploading:e,progress:0})}},{key:"handleProgress",value:function(e){console.log("handleProgress",e),this.setState({progress:e})}},{key:"handleUploadError",value:function(e){console.log("handleUploadError",e),this.setState({isUploading:null}),window.alert(e)}},{key:"handleUploadSuccess",value:function(e,t,a){console.log("handleUploadSuccess",e,t,a),E.a.storage().ref("images").child(a).getDownloadURL().then(function(a){var i=this.state.changed;switch(i.add(t),e){case 0:if(this.state.topicList[t]){var s=this.state.topicList;s[t].IMAGE_URL=a,this.setState({topicList:s,progress:100,isUploading:null,changed:i})}break;case 1:if(this.state.documentList[t]){var n=this.state.documentList;n[t].IMAGE_URL=a,this.setState({documentList:n,progress:100,isUploading:null,changed:i})}break;case 2:if(this.state.stepList[t]){var o=this.state.stepList;o[t].IMAGE_URL=a,this.setState({stepList:o,progress:100,isUploading:null,changed:i})}break;default:if(this.state.animationItemList[t]){var l=this.state.animationItemList;l[t].IMAGE_URL=a,this.setState({animationItemList:l,progress:100,isUploading:null,changed:i})}}}.bind(this))}},{key:"setSelected",value:function(e,t){switch(e){case 0:Object.keys(this.state.topicList).includes(t)?this.setState({topic:t,document:null,step:null,animationItem:null}):this.setState({topic:null,document:null,step:null,animationItem:null});break;case 1:if(Object.keys(this.state.documentList).includes(t)){var a=this.state.documentList[t].TOPIC_ID;Object.keys(this.state.topicList).includes(a)?this.setState({topic:a,document:t,step:null,animationItem:null}):this.setState({topic:null,document:null,step:null,animationItem:null})}else this.setState({document:null,step:null,animationItem:null});break;case 2:if(Object.keys(this.state.stepList).includes(t)){var i=this.state.stepList[t].DOCUMENT_ID;if(Object.keys(this.state.documentList).includes(i)){a=this.state.documentList[i].TOPIC_ID;Object.keys(this.state.topicList).includes(a)?this.setState({topic:a,document:i,step:t,animationItem:null}):this.setState({topic:null,document:null,step:null,animationItem:null})}else this.setState({document:null,step:null,animationItem:null})}else this.setState({step:null,animationItem:null});break;default:if(Object.keys(this.state.animationItemList).includes(t))this.state.animationItemList[t].STEP_ID===this.state.step&&this.setState({animationItem:t});else this.setState({animationItem:null})}}},{key:"setKeyValue",value:function(e,t,a,i,s){var n=this.state.changed;switch(e){case 0:if("TOPIC",!this.state.topicList[t])return;var o=this.state.topicList;o[t][i]=s,n.add(t),this.setState({topicList:o,changed:n});break;case 1:if("DOCUMENT",!this.state.documentList[t])return;var l=this.state.documentList,r=this.state.topic;if("TOPIC_ID"===i){if(!this.state.topicList[s])return;r=s}l[t][i]=s,n.add(t),this.setState({documentList:l,changed:n,topic:r});break;case 2:if("STEP",!this.state.stepList[t])return;var p=this.state.stepList,c=this.state.document;r=this.state.topic;if("DOCUMENT_ID"===i){if(!this.state.documentList[s])return;if(!this.state.topicList[this.state.documentList[s].TOPIC_ID])return;c=s,r=this.state.documentList[s].TOPIC_ID}p[t][i]=s,n.add(t),this.setState({stepList:p,changed:n,document:c,topic:r});break;default:if(!this.state.animationItemList[t])return;var d=this.state.animationItemList;d[t][i]=s,n.add(t),this.setState({animationItemList:d,changed:n})}}},{key:"add",value:function(e,t){var a="TOPIC",i=null;switch(e){case 0:a="TOPIC",i={IMAGE_URL:null,TOPIC_NAME:"New Topic",created:(new Date).getTime()};break;case 1:a="DOCUMENT",i={DIFFICULTY:1,DOCUMENT_NAME:"New Document",IMAGE_URL:null,INTRODUCTION:"Add Introduction Here ...",TOPIC_ID:t,available_scope:10,created:(new Date).getTime()};break;case 2:a="STEP",i={TYPE:1,ANSWER:"",CHOICES:"",ANSWER_EXPLANATION:"Good job!",DOCUMENT_ID:t,IMAGE_SUBTITLE:"Subtitle",IMAGE_URL:null,TEXT:"Add Text Here ...",PAGE_NUMBER:Object.values(this.state.stepList).filter((function(e){return e.DOCUMENT_ID===t})).length,created:(new Date).getTime()};break;default:a="ANIMATION_ITEM",i={DESCRIPTION:"New Animation Item",END_POSITION_X:0,END_POSITION_Y:0,START_POSITION_X:0,START_POSITION_Y:0,IMAGE_URL:null,SIZE:10,STEP_ID:t,created:(new Date).getTime()}}this.db.collection(a).add(i).then(function(t){switch(i.id=t.id,this.db.collection("var").doc("db_version").set({value:this.state.currentVersion+1}),e){case 0:var a=this.state.topicList;a[t.id]=i,this.setState({topic:t.id,topicList:a});break;case 1:var s=this.state.documentList;s[t.id]=i,this.setState({document:t.id,documentList:s});break;case 2:var n=this.state.stepList;n[t.id]=i,this.setState({step:t.id,stepList:n});break;default:var o=this.state.animationItemList;o[t.id]=i,this.setState({animationItem:t.id,animationItemList:o})}}.bind(this))}},{key:"updateAll",value:function(){var e=this;this.state.changed.forEach((function(t){e.update(0,t),e.update(1,t),e.update(2,t),e.update(3,t)}))}},{key:"update",value:function(e,t){var a="TOPIC",i=null;switch(e){case 0:a="TOPIC",i=this.state.topicList[t];break;case 1:a="DOCUMENT",i=this.state.documentList[t];break;case 2:a="STEP",i=this.state.stepList[t];break;default:a="ANIMATION_ITEM",i=this.state.animationItemList[t]}i&&this.db.collection(a).doc(t).set(i).then(function(){this.db.collection("var").doc("db_version").set({value:this.state.currentVersion+1});var e=this.state.changed;e.delete(t),this.setState({changed:e})}.bind(this))}},{key:"load",value:function(){var e={},t={},a={},i={};Promise.all([this.db.collection("TOPIC").get(),this.db.collection("DOCUMENT").get(),this.db.collection("STEP").get(),this.db.collection("ANIMATION_ITEM").get()]).then(function(s){var n=Object(l.a)(s,4),o=n[0],r=n[1],p=n[2],c=n[3];o.forEach((function(t){var a=t.data();!0!==a.hidden&&(a.id=t.id,e[t.id]=a)})),r.forEach((function(e){var t=e.data();!0!==t.hidden&&(t.id=e.id,a[e.id]=t)})),p.forEach((function(e){var a=e.data();!0!==a.hidden&&(a.id=e.id,t[e.id]=a)})),c.forEach((function(e){var t=e.data();!0!==t.hidden&&(t.id=e.id,i[e.id]=t)})),this.setState({topicList:e,documentList:a,stepList:t,animationItemList:i,changed:new Set})}.bind(this))}},{key:"render",value:function(){var e=this;this.props.window.onbeforeunload=function(e){0!==this.state.changed.size&&(console.log("onbeforeunload"),e.preventDefault(),e.returnValue="Really want to quit?")}.bind(this);return s.a.createElement(b.a,null,s.a.createElement("div",{style:{backgroundColor:this.state.editAnimation?"black":"white"}},s.a.createElement(S,{editAnimation:this.state.editAnimation}),s.a.createElement("hr",null),s.a.createElement(f.b,{exact:!0,path:"/",render:function(e){return s.a.createElement(A,null)}}),s.a.createElement(f.b,{path:"/home",render:function(t){return s.a.createElement("div",null,s.a.createElement(T.a,{primary:!0,disabled:0===e.state.changed.size,onClick:e.updateAll,style:{marginTop:"4em",marginLeft:"16px"}},e.state.changed.size," Change(s), Save All"),e.state.editAnimation?s.a.createElement(T.a,{disabled:!e.state.step,onClick:function(){e.setState({editAnimation:!1})},style:{marginTop:"4em",marginLeft:"16px"}},"Back"):s.a.createElement(T.a,{primary:!0,disabled:!e.state.step||e.state.stepList[e.state.step].TYPE>=10,onClick:function(){e.setState({editAnimation:!0})},style:{marginTop:"4em"}},"Edit Animation"),s.a.createElement(Z,{window:e.props.window,style:{backgroundImage:"url(".concat("https://firebasestorage.googleapis.com/v0/b/cell-app.appspot.com/o/bkimg?alt=media&token=4ea31dfb-89c0-4738-913f-066ab55c21f1",")")},editAnimation:e.state.editAnimation,setSelected:e.setSelected,topicSelected:e.state.topic,documentSelected:e.state.document,stepSelected:e.state.step,animationItemSelected:e.state.animationItem,lists:{topicList:e.state.topicList,documentList:e.state.documentList,stepList:e.state.stepList,animationItemList:e.state.animationItemList},update:e.update,load:e.load,add:e.add,setKeyValue:e.setKeyValue,changed:e.state.changed,uploadHelpers:e.uploadHelpers,isUploading:e.state.isUploading,progress:e.state.progress}))}})))}}]),t}(s.a.Component)),Q=a(426);document.onkeydown=function(e){if((e=e||window.event).ctrlKey)switch(e.which||e.keyCode){case 83:case 87:e.preventDefault(),e.stopPropagation()}},o.a.render(s.a.createElement(Q.a,null,s.a.createElement(J,{window:window})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[226,1,2]]]);
//# sourceMappingURL=main.230140e1.chunk.js.map